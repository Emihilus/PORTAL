{% extends 'base.html.twig' %}

{% block title %}Users list{{ parent() }}{% endblock %}

{% block body %}
<h1>Users list</h1>

{% for user in users %}
    {{user}} <a href="{{path('user-auctions',{username: user} )}}">show auctions</a> 

    {# admin options #}
    {% if true %}
    | is Verified? {% if user.isVerified == 1 %}<b class="text-success">yes</b> <a href='#' onclick="toggleVerification('{{user}}',true)">cancel verification</a>{% else %}<b class='text-danger'>no</b> <a href='#' onclick="toggleVerification('{{user}}',false)">verify</a>{% endif %} | 
    is Banned? <b class="text-success">no</b> <a href='#'>BAN</a> 
    {% endif %}

    <hr>
{% endfor %}

<pre>
    {{ dump(users) }}
</pre>
{% endblock %}

{% block javascripts %}
{{ parent() }}

<script>
function toggleVerification(username, action)
{
        fetch("{{path('toggleVerification')}}", 
        {
            method: 'POST',
            body: JSON.stringify(
                {
                    action,
                    username
                })
        })
        .then((response) => 
        {
            console.log(response);
            response.json().then(function(json)
            {
                console.log(json);

            });
        })
        .catch(() => { /* Error. Inform the user */ })
}
</script>
{% endblock %}