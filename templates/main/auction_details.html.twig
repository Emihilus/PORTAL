{% extends 'base.html.twig' %}

{% block title %}Aukcja pieca {{auction.title}}{% endblock %}



{% block body %}

<h1>Aukcja pieca {{auction.title}}</h1>
<BR>

<h2> ENDS AT {{auction.endsAt|date('Y-m-d h:m')}} </h2>

<p>{{auction.description}}</p>

<br>

<input id='offerInput' type="number" min="1" step="any" /> PLN  <button onclick='makeOffer()'>Offer</button><br>

{% for offer in auction.offers %}
    <b>Emis offers {{offer.value/100}} PLN</b> triggered at {{offer.createdAt|date('Y-m-d h:m')}} <br>
{% endfor %}

{% endblock %}

{% block javascripts %}
{{ parent() }}
<script>
function makeOffer()
{
    let offerValue = document.getElementById('offerInput').value;
  let url = "{{path ('makeOffer') }}";

    fetch(url, {
    method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
    body: {offerValue: offerValue}
  })
  .then((response) => {
      console.log(response)
      response.json().then(function(data) {
        console.log(data);
      });
  })
  .catch(() => { /* Error. Inform the user */ })
}
</script>
{% endblock %}